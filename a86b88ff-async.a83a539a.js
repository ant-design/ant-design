(("undefined"!=typeof globalThis?globalThis:self).makoChunk_antd=("undefined"!=typeof globalThis?globalThis:self).makoChunk_antd||[]).push([["a86b88ff"],{a86b88ff:function(e,t,d){"use strict";d.d(t,"__esModule",{value:!0}),d.d(t,"render",{enumerable:!0,get:function(){return f;}});var a=d("777fffbe"),i=d("b04a8d7d"),n=a._(d("117d3e41")),o=a._(d("1d8ba9c8")),r=d("f604571d");function s(e,t){e.forEach(e=>{let d={id:e.id,labelText:e.label,height:e.height,width:e.width,padding:e.padding??0};Object.keys(e).forEach(t=>{["id","label","height","width","padding","x","y"].includes(t)||(d[t]=e[t]);}),t.add({group:"nodes",data:d,position:{x:e.x??0,y:e.y??0}});});}function l(e,t){e.forEach(e=>{let d={id:e.id,source:e.start,target:e.end};Object.keys(e).forEach(t=>{["id","start","end"].includes(t)||(d[t]=e[t]);}),t.add({group:"edges",data:d});});}function g(e){return new Promise(t=>{let d=(0,r.select)("body").append("div").attr("id","cy").attr("style","display:none"),a=(0,n.default)({container:document.getElementById("cy"),style:[{selector:"edge",style:{"curve-style":"bezier"}}]});d.remove(),s(e.nodes,a),l(e.edges,a),a.nodes().forEach(function(e){e.layoutDimensions=()=>{let t=e.data();return{w:t.width,h:t.height};};}),a.layout({name:"cose-bilkent",quality:"proof",styleEnabled:!1,animate:!1}).run(),a.ready(e=>{i.log.info("Cytoscape ready",e),t(a);});});}function u(e){return e.nodes().map(e=>{let t=e.data(),d=e.position(),a={id:t.id,x:d.x,y:d.y};return Object.keys(t).forEach(e=>{"id"!==e&&(a[e]=t[e]);}),a;});}function c(e){return e.edges().map(e=>{let t=e.data(),d=e._private.rscratch,a={id:t.id,source:t.source,target:t.target,startX:d.startX,startY:d.startY,midX:d.midX,midY:d.midY,endX:d.endX,endY:d.endY};return Object.keys(t).forEach(e=>{["id","source","target"].includes(e)||(a[e]=t[e]);}),a;});}async function y(e,t){i.log.debug("Starting cose-bilkent layout algorithm");try{h(e);let t=await g(e),d=u(t),a=c(t);return i.log.debug(`Layout completed: ${d.length} nodes, ${a.length} edges`),{nodes:d,edges:a};}catch(e){throw i.log.error("Error in cose-bilkent layout algorithm:",e),e;}}function h(e){if(!e)throw Error("Layout data is required");if(!e.config)throw Error("Configuration is required in layout data");if(!e.rootNode)throw Error("Root node is required");if(!e.nodes||!Array.isArray(e.nodes))throw Error("No nodes found in layout data");if(!Array.isArray(e.edges))throw Error("Edges array is required in layout data");return!0;}n.default.use(o.default),(0,i.__name)(s,"addNodes"),(0,i.__name)(l,"addEdges"),(0,i.__name)(g,"createCytoscapeInstance"),(0,i.__name)(u,"extractPositionedNodes"),(0,i.__name)(c,"extractPositionedEdges"),(0,i.__name)(y,"executeCoseBilkentLayout"),(0,i.__name)(h,"validateLayoutData");var f=(0,i.__name)(async(e,t,{insertCluster:d,insertEdge:a,insertEdgeLabel:i,insertMarkers:n,insertNode:o,log:r,positionEdgeLabel:s},{algorithm:l})=>{let g={},u={},c=t.select("g");n(c,e.markers,e.type,e.diagramId);let h=c.insert("g").attr("class","subgraphs"),f=c.insert("g").attr("class","edgePaths"),m=c.insert("g").attr("class","edgeLabels"),b=c.insert("g").attr("class","nodes");r.debug("Inserting nodes into DOM for dimension calculation"),await Promise.all(e.nodes.map(async t=>{if(t.isGroup){let e={...t};u[t.id]=e,g[t.id]=e,await d(h,t);}else{let d={...t};g[t.id]=d;let a=await o(b,t,{config:e.config,dir:e.direction||"TB"}),i=a.node().getBBox();d.width=i.width,d.height=i.height,d.domId=a,r.debug(`Node ${t.id} dimensions: ${i.width}x${i.height}`);}})),r.debug("Running cose-bilkent layout algorithm");let p={...e,nodes:e.nodes.map(e=>{let t=g[e.id];return{...e,width:t.width,height:t.height};})},w=await y(p,e.config);r.debug("Positioning nodes based on layout results"),w.nodes.forEach(e=>{let t=g[e.id];(null==t?void 0:t.domId)&&(t.domId.attr("transform",`translate(${e.x}, ${e.y})`),t.x=e.x,t.y=e.y,r.debug(`Positioned node ${t.id} at center (${e.x}, ${e.y})`));}),w.edges.forEach(t=>{let d=e.edges.find(e=>e.id===t.id);d&&(d.points=[{x:t.startX,y:t.startY},{x:t.midX,y:t.midY},{x:t.endX,y:t.endY}]);}),r.debug("Inserting and positioning edges"),await Promise.all(e.edges.map(async t=>{await i(m,t);let d=g[t.start??""],n=g[t.end??""];if(d&&n){let i=w.edges.find(e=>e.id===t.id);if(i){r.debug("APA01 positionedEdge",i);let o={...t},l=a(f,o,u,e.type,d,n,e.diagramId);s(o,l);}else{let i={...t,points:[{x:d.x||0,y:d.y||0},{x:n.x||0,y:n.y||0}]},o=a(f,i,u,e.type,d,n,e.diagramId);s(i,o);}}})),r.debug("Cose-bilkent rendering completed");},"render");}}]);