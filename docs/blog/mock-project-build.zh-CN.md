---
title: ä¾èµ–æ’æŸ¥
date: 2023-04-13
author: zombieJ
---

Ant Design ä½œä¸ºå¤§å‹ç»„ä»¶åº“ï¼Œå†…éƒ¨ä¾èµ–ååˆ†å¤æ‚ã€‚æœ‰æ—¶å€™ antd ä»£ç æœ¬èº«æ²¡æœ‰æ”¹åŠ¨ï¼Œä½†æ˜¯åº•å±‚ä¾èµ–æ›´æ–°ä¹Ÿå¯èƒ½å¯¼è‡´å¼€å‘è€…çš„æ„å»ºå¤±è´¥ã€‚æ¯”å¦‚æœ€è¿‘ç”±äºæˆ‘çš„å¤±è¯¯ï¼Œä¸€å¤„[è·¯å¾„å¤§å°å†™é”™è¯¯](https://github.com/ant-design/ant-design/issues/41236)ä½¿å¾—åœ¨ Linux ä¸‹ä¼šæ„å»ºå¤±è´¥ã€‚

å¯¹äºæˆ‘ä»¬è‡ªå·±ç®¡ç†çš„ä¾èµ–åŒ…ï¼Œæˆ‘ä»¬å®šä½é—®é¢˜ä¼šæ¯”è¾ƒç®€å•ã€‚ä½†æ˜¯å¯¹äºç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œå¾€å¾€å¾ˆéš¾ç¬¬ä¸€æ—¶é—´å‘ç°ã€‚å½“ç”¨æˆ·åé¦ˆæ—¶ï¼Œå¯èƒ½å·²ç»è¿‡äº†æ•°ä¸ªå°æ—¶ï¼Œä½¿å¾—åœ¨å‡ ç™¾ä¸ªåŒ…é‡Œæ‰¾ä¸åŒå˜å¾—æœ‰äº›å›°éš¾ã€‚æˆ‘ä»¬ç´¯ç§¯äº†ä¸€äº›æ’æŸ¥ç»éªŒä¼šä¸å¤§å®¶åˆ†äº«ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿä¸ºäº†æ›´å¿«è§£å†³é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿåšäº†é¢å¤–çš„ä¸€äº›äº‹æƒ…ã€‚

### ç¡®å®šä¿¡æ¯

æˆ‘ä»¬ä¸º Github issue æ·»åŠ äº†ä¸€ä¸ª[æ¨¡æ¿ç«™ç‚¹](https://new-issue.ant.design/)ï¼Œå¼€å‘è€…åœ¨æäº¤é—®é¢˜æ—¶ä¼šçœ‹åˆ°å¦‚ä¸‹è¡¨æ ¼ï¼Œä¼šè®©å¼€å‘è€…å°½é‡å®Œæ•´çš„å¡«å†™ç›¸å…³ä¿¡æ¯ï¼š

![Issue Helper](https://user-images.githubusercontent.com/5378891/231633510-2e7c7819-12c2-4153-b3c8-4d5576116a08.png)

é€šè¿‡ antd ç‰ˆæœ¬ã€React ç‰ˆæœ¬ã€ç³»ç»Ÿã€æµè§ˆå™¨ç‰ˆæœ¬ ä¿¡æ¯å¯ä»¥ç»„åˆå‡ºå¤§å¤šæ•°é”™è¯¯é—®é¢˜ï¼Œå¸®åŠ©å°½å¯èƒ½çš„ç¼©å°æ’æŸ¥èŒƒå›´ã€‚è®©æˆ‘ä»¬å¤§è‡´ç¡®å®šå®ƒæ˜¯å¦æ˜¯ä¸€ä¸ªé€šç”¨é—®é¢˜æˆ–è€…æ˜¯ä¸€ä¸ªç‰¹å®šç³»ç»Ÿçš„é—®é¢˜ã€‚è¿™é‡Œæˆ‘ä»¬å°±ä¸è®²ç»„ä»¶å®ç° BUGï¼Œå•è®²è®²ä¾èµ–é—®é¢˜ã€‚

### ç¡®å®šèŒƒå›´

ä» issue è¢«å‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ github çš„ commit CI å€’æ¨å‡ºæ—¶é—´èŒƒå›´ï¼š

![Commit List](https://user-images.githubusercontent.com/5378891/231635576-88a84f55-11d9-403c-bece-98d55bf5b893.png)

æ¥ç€é€šè¿‡ issue æè¿°å¯ä»¥ç¡®å®šå¤§è‡´çš„åŒ…å’Œå“ªäº›ç›¸å…³ï¼ˆä¾‹å¦‚ [#41236](https://github.com/ant-design/ant-design/issues/41236) æ¥è‡ª `@rc-component/trigger`ã€[#15930](https://github.com/ant-design/ant-design/issues/15930) æ¥è‡ª `@types/react`ï¼‰ã€‚ç„¶åé€šè¿‡ npm æŸ¥çœ‹ç›¸å…³çš„åŒ…çš„ç‰ˆæœ¬å‘å¸ƒæƒ…å†µï¼š

![Publish Time](https://user-images.githubusercontent.com/5378891/231636272-e423301a-f8df-407e-8d4e-a49e219631e4.png)

åœ¨ç¡®å®šèŒƒå›´åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡å®‰è£…å…ˆå‰ç‰ˆæœ¬è¿›è¡Œæ„å»ºçš„æ–¹å¼æ’æŸ¥å‡ºæœ‰é—®é¢˜çš„ç‰ˆæœ¬ã€‚æš‚æ—¶åœ¨ package.json ä¸­é”å®šå¹¶å‘å¸ƒ patch ç‰ˆæœ¬ä»¥è§£å†³ä¾èµ–é—®é¢˜ï¼ˆåœ¨ä¿®å¤ä¹‹åè§£é™¤é”å®šï¼‰ã€‚åŒæ—¶ä¹Ÿä¼šå‘å¯¹åº”çš„ Github æ issueï¼ˆå½“ç„¶ï¼Œå¦‚æœå·²ç»æœ‰äº†å» +1 å³å¯ï¼‰ã€‚

### å®šæ—¶æ„å»º

å¦‚ä½ æ‰€è§ï¼Œä¸Šè¿°çš„æ’æŸ¥æ–¹å¼æœ‰ä¸€å®šçš„æ»åæ€§ã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡å®šæ—¶æ„å»ºçš„æ–¹å¼å‡å°‘é¢å¤–çš„äººåŠ›åŠ³åŠ¨ï¼ŒåŒæ—¶ä¹Ÿèƒ½è®©æˆ‘ä»¬æ›´å¿«çš„å‘ç°é—®é¢˜ã€‚å› è€Œæˆ‘ä»¬å¤ç”¨äº† [create-next-app-antd](https://github.com/ant-design/create-next-app-antd) é¡¹ç›®ä½œä¸ºåŸºåº•ï¼ˆè¿™æ ·ï¼Œå¦‚æœæ¨¡æ¿é¡¹ç›®å‡ºäº†é—®é¢˜ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥æå‰å‘ç°ï¼‰ã€‚åˆ›å»ºäº†ä¸€ä¸ªæ¯åŠå°æ—¶æ‰§è¡Œä¸€æ¬¡çš„ `mock-project-build.yml` CIï¼Œå®ƒä¼šå®šæœŸæ‹‰å– [create-next-app-antd](https://github.com/ant-design/create-next-app-antd) repo è¿›è¡Œæ„å»ºï¼š

```yml
on:
  workflow_dispatch:
  schedule:
    - cron: '*/30 * * * *'
```

é€šè¿‡ `--depth=1` åªæ‹‰å–æœ€åä¸€æ¬¡ commitã€‚å†æ‰§è¡Œ `yarn` å®‰è£…ä¾èµ–ç”Ÿæˆå¯¹åº”çš„ `yarn.lock` æ–‡ä»¶ï¼Œæœ€åæ‰§è¡Œ `yarn build` è¿›è¡Œæ„å»ºä»¥å®Œå…¨æ¨¡æ‹Ÿä¸€ä¸ªé¡¹ç›®çš„æ„å»ºè¿‡ç¨‹ã€‚

æ¯æ¬¡æ„å»ºæˆåŠŸï¼ŒCI éƒ½ä¼šç¼“å­˜å½“ä¸‹çš„ `yarn.lock` æ–‡ä»¶ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨ä¸‹æ¬¡æ„å»ºå¦‚æœå¤±è´¥äº†ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‹‰å–ä¸¤ä»½æ–‡ä»¶è¿›è¡Œå¯¹æ¯”å»æ’æŸ¥é—®é¢˜ã€‚`actions/cache` è™½ç„¶ä¸å…è®¸åŒå cache keyï¼Œä½†æ˜¯å…è®¸é€šè¿‡ `restore-keys` æ¥è·å–æœ€è¿‘çš„ cacheï¼Œè¿™å°±éå¸¸æ–¹ä¾¿äº†ï¼š

```yml
- uses: actions/cache@v3
  with:
    path: ~tmpProj/yarn.lock
    key: primes-${{ runner.os }}-${{ github.run_id }}
    restore-keys: mock-proj-lock-file
```

æ¥ç€ç›‘å¬æ„å»ºå¤±è´¥äº‹ä»¶ï¼Œå¯¹ `yarn.lock` æ–‡ä»¶è¿›è¡Œå¯¹æ¯”å¿«é€Ÿæ‰¾å‡ºå˜åŒ–çš„ä¾èµ–ï¼š

```yml
- name: ğŸ¨ Diff Report
  if: ${{ failure() }}
  run: npx diff-yarn-lock --source=~tmpProj/yarn.lock --target=~tmpProj/yarn.lock.failed
```

![Diff](https://user-images.githubusercontent.com/5378891/226313045-83895072-57c1-4135-80cf-16eeecae8c18.png)

![Build List](https://user-images.githubusercontent.com/5378891/231641305-88ec5d5e-6879-458a-8660-9d9828b97fd9.png)

æˆ‘ä»¬åœ¨å¤±è´¥æ—¶è¿˜ä¼šé€šè¿‡ IM æ¨é€åè®®å°†æ¶ˆæ¯æ¨é€åˆ°å¼€å‘è€…ç¾¤ç»„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç¬¬ä¸€æ—¶é—´ç¡®å®šé—®é¢˜ã€‚å®Œæ•´è„šæœ¬å¯ä»¥[ç‚¹å‡»æ­¤å¤„](https://github.com/ant-design/ant-design/blob/da83561f9cb57b0eb03d18543d96393689f799be/.github/workflows/mock-project-build.yml)æŸ¥çœ‹ã€‚

### æœ€å

æˆ‘ä»¬ä¸€ç›´åœ¨æŒç»­ä¼˜åŒ–åœ¨ç»´æŠ¤è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨ä¸­æœ‰ä»»ä½•å¥½çš„æƒ³æ³•æˆ–è€…å»ºè®®ï¼Œéƒ½æ¬¢è¿åœ¨æˆ‘ä»¬çš„ issue å’Œ discussion æå‡ºã€‚æ„Ÿè°¢å¤§å®¶~
